import{c as j,r as i,j as e,b as f,A as g}from"./index-B3rW1R1Q.js";import{_ as d,X as b,a as x,C as N}from"./dialog-XDGJ0_ue.js";import{A as v}from"./alert-triangle-CJqp8ht0.js";import{f as y}from"./formatDistanceToNow-aDLjEcHe.js";import{P as w}from"./plus-BvZ-vl3o.js";const m=j(s=>({targets:[],activeAttacks:0,addTarget:(t,a,c)=>{const r={id:crypto.randomUUID(),host:t,port:a,service:c,status:"pending",createdAt:new Date().toISOString(),attempts:0,successCount:0,credentials:[]};s(n=>({targets:[r,...n.targets],activeAttacks:n.activeAttacks+1}))},removeTarget:t=>{s(a=>({targets:a.targets.filter(c=>c.id!==t)}))},updateTarget:(t,a)=>{s(c=>({targets:c.targets.map(r=>r.id===t?{...r,...a}:r)}))}}));function C({isOpen:s,onClose:t}){const[a,c]=i.useState(""),[r,n]=i.useState(""),[o,u]=i.useState("SSH"),h=m(l=>l.addTarget),p=l=>{l.preventDefault(),a.trim()&&r&&(h(a.trim(),parseInt(r,10),o),c(""),n(""),t())};return e.jsxs(d,{open:s,onClose:t,className:"relative z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:e.jsxs(d.Panel,{className:"mx-auto max-w-md rounded-lg bg-gray-900 p-6 border border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(d.Title,{className:"text-lg font-medium text-white",children:"New Brute Force Attack"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white",children:e.jsx(b,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"host",className:"block text-sm font-medium text-gray-300",children:"Target Host"}),e.jsx("input",{type:"text",id:"host",value:a,onChange:l=>c(l.target.value),className:"mt-1 block w-full rounded-md border border-gray-700 bg-gray-800 text-white px-3 py-2 text-sm focus:border-[#8B5CF6] focus:outline-none focus:ring-1 focus:ring-[#8B5CF6]",placeholder:"example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"port",className:"block text-sm font-medium text-gray-300",children:"Port"}),e.jsx("input",{type:"number",id:"port",value:r,onChange:l=>n(l.target.value),className:"mt-1 block w-full rounded-md border border-gray-700 bg-gray-800 text-white px-3 py-2 text-sm focus:border-[#8B5CF6] focus:outline-none focus:ring-1 focus:ring-[#8B5CF6]",placeholder:"22"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"service",className:"block text-sm font-medium text-gray-300",children:"Service"}),e.jsxs("select",{id:"service",value:o,onChange:l=>u(l.target.value),className:"mt-1 block w-full rounded-md border border-gray-700 bg-gray-800 text-white px-3 py-2 text-sm focus:border-[#8B5CF6] focus:outline-none focus:ring-1 focus:ring-[#8B5CF6]",children:[e.jsx("option",{value:"SSH",children:"SSH"}),e.jsx("option",{value:"FTP",children:"FTP"}),e.jsx("option",{value:"HTTP",children:"HTTP"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm text-gray-300 hover:text-white",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-[#8B5CF6] text-white rounded-md hover:bg-[#7C3AED] text-sm",children:"Start Attack"})]})]})]})})]})}function S({target:s,onRemove:t}){const a=()=>{switch(s.status){case"running":return e.jsx(g,{className:"h-5 w-5 text-[#3B82F6] animate-pulse"});case"completed":return e.jsx(N,{className:"h-5 w-5 text-green-500"});case"failed":return e.jsx(x,{className:"h-5 w-5 text-red-500"});default:return e.jsx(v,{className:"h-5 w-5 text-yellow-500"})}};return e.jsxs("div",{className:"bg-gray-900 rounded-lg border border-gray-800 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[a(),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:s.host}),e.jsxs("p",{className:"text-sm text-gray-400",children:[s.service," - Port ",s.port]})]})]}),e.jsx("button",{onClick:()=>t(s.id),className:"text-gray-400 hover:text-white",children:e.jsx(x,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Status"}),e.jsx("span",{className:f("capitalize",s.status==="running"&&"text-[#3B82F6]",s.status==="completed"&&"text-green-500",s.status==="failed"&&"text-red-500",s.status==="pending"&&"text-yellow-500"),children:s.status})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Started"}),e.jsx("span",{className:"text-white",children:y(new Date(s.createdAt),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Success Rate"}),e.jsxs("span",{className:"text-white",children:[(s.successCount/Math.max(s.attempts,1)*100).toFixed(1),"%"]})]}),s.successCount>0&&e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-green-500",children:"Credentials Found"}),e.jsx("span",{className:"text-green-500 font-medium",children:s.successCount})]})]})]})}function P(){const[s,t]=i.useState(!1),{targets:a,removeTarget:c}=m();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Brute Force"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Test login credential strength for various services"})]}),e.jsxs("button",{onClick:()=>t(!0),className:"flex items-center space-x-2 px-4 py-2 bg-[#8B5CF6] text-white rounded-md hover:bg-[#7C3AED]",children:[e.jsx(w,{className:"h-5 w-5"}),e.jsx("span",{children:"New Attack"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.map(r=>e.jsx(S,{target:r,onRemove:c},r.id)),a.length===0&&e.jsx("div",{className:"col-span-full flex flex-col items-center justify-center py-12 bg-gray-900 rounded-lg border border-gray-800",children:e.jsxs("div",{className:"text-gray-400 text-center",children:[e.jsx("p",{className:"mt-2",children:"No brute force attacks running"}),e.jsx("button",{onClick:()=>t(!0),className:"mt-4 text-[#8B5CF6] hover:text-[#7C3AED]",children:"Start your first attack"})]})})]}),e.jsx(C,{isOpen:s,onClose:()=>t(!1)})]})}export{P as default};
